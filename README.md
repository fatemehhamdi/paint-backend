# 🎨 Paint Loui Backend - Spring Boot API

یک بک‌اند Spring Boot ساخته شده برای اپلیکیشن نقاشی Paint Loui است که امکان ثبت‌نام و ورود کاربران، دریافت توکن JWT و ذخیره/بازیابی نقاشی‌ها را فراهم می‌کند. هنگام راه‌اندازی پروژه، چهار کاربر پیش‌فرض (adminn، user1، user2، user3) توسط سیستم به‌طور خودکار ایجاد می‌شوند و می‌توان مستقیماً با آن‌ها تست کرد.

## 🏗️ معماری پروژه

ساختار پروژه مبتنی بر معماری لایه‌ای استاندارد است: کنترلرها وظیفه مدیریت درخواست‌های HTTP را بر عهده دارند، منطق برنامه در سرویس‌ها پیاده‌سازی می‌شود، دسترسی به دیتابیس توسط ریپازیتوری‌ها انجام شده و مدل‌های داده نیز به صورت جدا تعریف شده‌اند. چنین ساختاری باعث می‌شود پیاده‌سازی و نگهداری برنامه در آینده ساده‌تر باشد.

## 🔗 پیاده‌سازی API Endpoints

### کنترلر احراز هویت
دو endpoint اصلی وجود دارد: یکی برای ثبت‌نام که ابتدا username و password را از کاربر گرفته، در دیتابیس چک می‌کند که تکراری نباشد، پسورد را با BCrypt رمزنگاری می‌کند و سپس کاربر جدید را ثبت می‌کند؛ دیگری برای ورود که اطلاعات را بررسی می‌کند و در صورت صحت JWT token صادر می‌کند.

### کنترلر نقاشی
برای ذخیره نقاشی، کاربر باید وارد شده باشد؛ سمت سرور ابتدا با استفاده از توکن JWT صحت درخواست را می‌سنجد، سپس داده‌های نقاشی (title و اطلاعات canvas به صورت JSON) را ذخیره یا اگر قبلاً نقاشی‌ای وجود داشته، بروزرسانی می‌کند. در endpoint مربوط به خواندن نقاشی نیز آخرین نقاشی کاربر بازگردانده می‌شود.

## 🗄️ ساختار داده‌ها

داده‌های canvas به صورت یک رشته JSON ذخیره می‌شوند تا اطلاعات مربوط به اشکال و خصوصیات آن‌ها به ساده‌ترین حالت ممکن بین بک‌اند و فرانت‌اند جابجا شود. هر کاربر می‌تواند بیش از یک نقاشی داشته باشد و رابطه نهادها به صورت یک-به-چند تعریف شده است.

مدل User شامل اطلاعات پایه کاربر است که پسوردش hash شده و username یکتا است. مدل Painting شامل title، canvas_data به شکل JSON و ارجاع به کاربر است که امکان ذخیره انواع مختلف اشکال و خصوصیاتشان را فراهم می‌کند.

## 🔐 سیستم امنیتی

امنیت برنامه با توکن JWT مدیریت می‌شود؛ فیلتر مخصوصی همه درخواست‌ها را بررسی می‌کند و در صورت نبود یا نامعتبر بودن توکن، اجازه دسترسی به endpointهای محافظت‌شده داده نمی‌شود. فقط endpointهای ورود و ثبت‌نام عمومی هستند و باقی منابع نیازمند ورود کاربرند. همچنین Cross-Origin برای ارتباط با فرانت‌اند روی localhost فعال شده است.

## 🗃️ مدیریت دیتابیس

دیتابیس برنامه با PostgreSQL مدیریت می‌شود و JPA/Hibernate نیز ساخت و بروزرسانی جداول را به‌طور اتوماتیک انجام می‌دهد. کلاس DataSeeder هم هنگام راه‌اندازی اپلیکیشن، چهار کاربر تستی را بررسی کرده و در صورت عدم وجود، آن‌ها را با پسوردهای رمزگذاری شده در دیتابیس وارد می‌کند.

## 🔄 جریان عملیاتی

راه‌اندازی با شروع Spring Boot، اتصال به دیتابیس، ساخت خودکار جداول، اجرای DataSeeder برای ایجاد کاربران پیش‌فرض و بارگذاری تنظیمات امنیتی انجام می‌شود. فرآیند register شامل اعتبارسنجی ورودی، بررسی عدم تکرار username، رمزگذاری پسورد و ایجاد user جدید است. در login اطلاعات validate شده و JWT token تولید می‌شود.

## 🛠️ ویژگی‌های فنی

مدیریت خطا و اعتبارسنجی ورودی‌ها در controllerها انجام می‌شود و پیام‌های مناسب برگردانده خواهد شد. همچنین اطلاعات حساس در error response نمایش داده نمی‌شود. داده‌ها تحت تراکنش ذخیره می‌شوند تا سازگاری حفظ گردد و از راهکارهای بهینه مثل lazy loading نیز استفاده شده است.

هر کاربر تنها یک painting فعال دارد که memory usage و پیچیدگی را کاهش می‌دهد. بهینه‌سازی‌ها شامل transaction management برای consistency داده‌ها و JWT stateless authentication برای scalability است.

## 🚀 آمادگی برای استقرار

روی‌هم‌رفته این بک‌اند با قابلیت اتصال راحت به فرانت‌اند React توسعه پیدا کرده، CORS از پیش تنظیم شده، از JSON format برای JavaScript handling استفاده می‌کند و error handling مناسبی دارد. جداول خودکار ایجاد شده، کاربران پیش‌فرض خودشان setup می‌شوند و نیازی به initialization دستی نیست.

امنیت تولید شامل رمزگذاری پسورد با BCrypt، مدیریت JWT token و error response بدون اطلاعات حساس برای محیط production آماده است. این backend یک بنیان محکم و قابل توسعه برای paint application فراهم می‌کند.

## 🤖 کمک هوش مصنوعی Claude

Claude در چند بخش کلیدی به توسعه این پروژه کمک کرده است:

**حل مشکل CORS**: هنگامی که فرانت‌اند نمی‌توانست به بک‌اند متصل شود، Claude کمک کرد تا تنظیمات CORS در SecurityConfig و استفاده از @CrossOrigin در controllerها به درستی پیاده‌سازی شود.

**پارس کردن JSON**: برای تبدیل جیسون به استرینگ توی بک و تبدیل استرینگ به جیسون توی فرانت کمک کرد و راهکار استفاده از Jackson ObjectMapper و پیاده‌سازی DTOهای مناسب برای SavePaintingRequest و LoadPaintingResponse را ارائه داد.

**ایجاد کاربران پیش‌فرض**: Claude ایده ساخت کلاس DataSeeder را پیشنهاد داد که با استفاده از CommandLineRunner، چهار کاربر تستی را در startup به صورت خودکار و تحت transaction ایجاد می‌کند تا فرآیند تست ساده‌تر شود.